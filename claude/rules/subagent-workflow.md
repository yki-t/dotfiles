# サブエージェント利用時のワークフロー

## 適用条件

このワークフローは `prohibitions.md` の「承認を得ずに実行することは禁止」の例外として扱う。
コード編集を行うサブエージェントを使用する場合、このワークフローに従ってください。

## ワークフロー

### 1. 事前準備

サブエージェントをspawnする前に、編集対象ファイルを git add してください。

```bash
git add <編集対象ファイル1> <編集対象ファイル2> ...
```

**禁止**: `git add .` や `git add -A` は使用しないでください。ファイルを明示的に指定してください。

### 2. サブエージェント実行

サブエージェントに編集タスクを委譲します。複数のサブエージェントを並列実行しても構いません。

### 3. 変更の検証

全サブエージェント完了後、`subagents-checker` エージェントに編集要件を渡してください。
subagents-checker が自分で `git diff` を実行して検証します。

```
subagents-checker に渡すプロンプト例：

## 編集要件
- <要件1>
- <要件2>
```

### 4. 結果の判断

subagents-checker の結果に応じて：

- **PASS**: 次のタスクに進む
- **PARTIAL / FAIL**:
  - 自分で修正する、または
  - ステップ2からやり直す（再度サブエージェントに依頼）

### 5. 後処理

検証完了後、問題なければ code-reviewer でコード品質レビューを行ってください。
問題がある場合、再度サブエージェントに依頼するか、自分で修正してください。
この時は
 - 当初の編集要件が満たされていること
 - コードベース全体として品質がたもたれていること (プロジェクト依存ですが、例えば lint エラーがない等)
を確認して、これらの問題がある場合はユーザーへの承認なしに修正もしくは差し戻しを行い、再度 subagents-checker にかけてください。

## 注意事項

- このワークフローは編集系サブエージェントにのみ適用されます（調査・レビュー系は対象外）
